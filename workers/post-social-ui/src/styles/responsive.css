/**
 * Responsive Utilities
 *
 * Mobile-first breakpoint utilities for post-social-ui
 *
 * Breakpoints:
 *   xs: 320px  - Small phones (iPhone SE)
 *   sm: 480px  - Large phones
 *   md: 768px  - Tablets
 *   lg: 1024px - Laptops
 *   xl: 1280px - Desktops
 *   2xl: 1536px - Large monitors
 *
 * Usage:
 *   .hidden-mobile  - Hidden below 768px
 *   .hidden-desktop - Hidden at 768px and above
 *   .show-sm        - Display block at 480px+
 *   etc.
 */

/* =============================================================================
   Display Utilities by Breakpoint
   ============================================================================= */

/* Hide on mobile (below md breakpoint) */
.hidden-mobile {
  display: none;
}

@media (min-width: 768px) {
  .hidden-mobile {
    display: block;
  }

  .hidden-mobile.flex {
    display: flex;
  }

  .hidden-mobile.inline {
    display: inline;
  }

  .hidden-mobile.inline-flex {
    display: inline-flex;
  }
}

/* Hide on desktop (md breakpoint and above) */
@media (min-width: 768px) {
  .hidden-desktop {
    display: none !important;
  }
}

/* Show utilities - hidden by default, shown at breakpoint */
.show-xs,
.show-sm,
.show-md,
.show-lg,
.show-xl {
  display: none;
}

@media (min-width: 320px) {
  .show-xs { display: block; }
  .show-xs.flex { display: flex; }
  .show-xs.inline { display: inline; }
}

@media (min-width: 480px) {
  .show-sm { display: block; }
  .show-sm.flex { display: flex; }
  .show-sm.inline { display: inline; }
}

@media (min-width: 768px) {
  .show-md { display: block; }
  .show-md.flex { display: flex; }
  .show-md.inline { display: inline; }
}

@media (min-width: 1024px) {
  .show-lg { display: block; }
  .show-lg.flex { display: flex; }
  .show-lg.inline { display: inline; }
}

@media (min-width: 1280px) {
  .show-xl { display: block; }
  .show-xl.flex { display: flex; }
  .show-xl.inline { display: inline; }
}

/* Hide at specific breakpoints and above */
@media (min-width: 480px) {
  .hide-sm-up { display: none !important; }
}

@media (min-width: 768px) {
  .hide-md-up { display: none !important; }
}

@media (min-width: 1024px) {
  .hide-lg-up { display: none !important; }
}

/* =============================================================================
   Fluid Container
   ============================================================================= */

.container-fluid {
  width: 100%;
  padding-left: var(--container-padding);
  padding-right: var(--container-padding);
  padding-left: max(var(--container-padding), var(--safe-area-left));
  padding-right: max(var(--container-padding), var(--safe-area-right));
}

.container-content {
  width: 100%;
  max-width: var(--content-max-width);
  margin-left: auto;
  margin-right: auto;
  padding-left: var(--container-padding);
  padding-right: var(--container-padding);
}

/* =============================================================================
   Touch Target Utilities
   ============================================================================= */

.touch-target {
  min-height: var(--touch-target-min);
  min-width: var(--touch-target-min);
}

.touch-target-comfortable {
  min-height: var(--touch-target-comfortable);
  min-width: var(--touch-target-comfortable);
}

/* Ensure clickable areas are large enough on mobile */
@media (max-width: 767px) {
  .touch-expand {
    position: relative;
  }

  .touch-expand::before {
    content: '';
    position: absolute;
    top: -8px;
    left: -8px;
    right: -8px;
    bottom: -8px;
  }
}

/* =============================================================================
   Safe Area Utilities (iOS notch, etc.)
   ============================================================================= */

.safe-area-top {
  padding-top: var(--safe-area-top);
}

.safe-area-bottom {
  padding-bottom: var(--safe-area-bottom);
}

.safe-area-left {
  padding-left: var(--safe-area-left);
}

.safe-area-right {
  padding-right: var(--safe-area-right);
}

.safe-area-inset {
  padding-top: var(--safe-area-top);
  padding-bottom: var(--safe-area-bottom);
  padding-left: var(--safe-area-left);
  padding-right: var(--safe-area-right);
}

/* =============================================================================
   Responsive Spacing
   ============================================================================= */

/* Padding that scales with viewport */
.p-responsive {
  padding: var(--container-padding);
}

.px-responsive {
  padding-left: var(--container-padding);
  padding-right: var(--container-padding);
}

.py-responsive {
  padding-top: var(--container-padding);
  padding-bottom: var(--container-padding);
}

/* Gap that scales with viewport */
.gap-responsive {
  gap: clamp(var(--space-sm), 2vw, var(--space-lg));
}

/* =============================================================================
   Responsive Text
   ============================================================================= */

.text-fluid-sm {
  font-size: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem);
}

.text-fluid-base {
  font-size: clamp(0.875rem, 0.8rem + 0.35vw, 1rem);
}

.text-fluid-lg {
  font-size: clamp(1rem, 0.9rem + 0.5vw, 1.25rem);
}

.text-fluid-xl {
  font-size: clamp(1.25rem, 1rem + 1vw, 1.75rem);
}

.text-fluid-2xl {
  font-size: clamp(1.5rem, 1.2rem + 1.5vw, 2.25rem);
}

/* =============================================================================
   Responsive Layout Helpers
   ============================================================================= */

/* Stack on mobile, row on desktop */
.stack-to-row {
  display: flex;
  flex-direction: column;
  gap: var(--space-md);
}

@media (min-width: 768px) {
  .stack-to-row {
    flex-direction: row;
  }
}

/* Row on mobile, stack on narrow screens */
.row-to-stack {
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  gap: var(--space-sm);
}

@media (max-width: 479px) {
  .row-to-stack {
    flex-direction: column;
  }
}

/* Full width on mobile */
.full-mobile {
  width: 100%;
}

@media (min-width: 768px) {
  .full-mobile {
    width: auto;
  }
}

/* =============================================================================
   Responsive Grid
   ============================================================================= */

.grid-responsive {
  display: grid;
  gap: var(--space-md);
  grid-template-columns: 1fr;
}

@media (min-width: 480px) {
  .grid-responsive {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (min-width: 1024px) {
  .grid-responsive {
    grid-template-columns: repeat(3, 1fr);
  }
}

@media (min-width: 1280px) {
  .grid-responsive {
    grid-template-columns: repeat(4, 1fr);
  }
}

/* Auto-fit grid with minimum size */
.grid-auto-fit {
  display: grid;
  gap: var(--space-md);
  grid-template-columns: repeat(auto-fit, minmax(min(280px, 100%), 1fr));
}

.grid-auto-fill {
  display: grid;
  gap: var(--space-md);
  grid-template-columns: repeat(auto-fill, minmax(min(280px, 100%), 1fr));
}

/* =============================================================================
   Scroll Behavior
   ============================================================================= */

/* Horizontal scroll container for mobile */
.scroll-x-mobile {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;
}

.scroll-x-mobile::-webkit-scrollbar {
  display: none;
}

@media (min-width: 768px) {
  .scroll-x-mobile {
    overflow-x: visible;
  }
}

/* Lock scroll on body when modal/sheet is open */
.scroll-lock {
  overflow: hidden;
  position: fixed;
  width: 100%;
  height: 100%;
}

/* =============================================================================
   Aspect Ratio Helpers
   ============================================================================= */

.aspect-square {
  aspect-ratio: 1 / 1;
}

.aspect-video {
  aspect-ratio: 16 / 9;
}

.aspect-portrait {
  aspect-ratio: 3 / 4;
}

/* =============================================================================
   Accessibility: Reduced Motion
   ============================================================================= */

@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Utility to opt-out of reduced motion (use sparingly) */
@media (prefers-reduced-motion: reduce) {
  .motion-safe {
    animation-duration: var(--duration-normal) !important;
    transition-duration: var(--duration-normal) !important;
  }
}

/* =============================================================================
   Print Utilities
   ============================================================================= */

@media print {
  .no-print {
    display: none !important;
  }

  .print-only {
    display: block !important;
  }
}

.print-only {
  display: none;
}

/* =============================================================================
   Virtual Keyboard Handling
   ============================================================================= */

/* These classes can be toggled via JS when keyboard state changes */

/* Shrink content when keyboard is open */
.keyboard-open {
  /* Applied to body or container */
}

.keyboard-open .editor-panel {
  /* Reduce height to fit above keyboard */
  max-height: var(--viewport-height, 100vh);
}

.keyboard-open .editor-footer {
  /* Ensure footer stays visible above keyboard */
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  padding-bottom: env(safe-area-inset-bottom, 0);
}

.keyboard-open .editor-content {
  /* Shrink editor to make room for keyboard */
  max-height: calc(var(--viewport-height, 60vh) - 200px);
  overflow-y: auto;
}

/* Utility to scroll active element into view */
.scroll-into-view-on-focus:focus {
  scroll-margin-bottom: 120px;
}

/* =============================================================================
   Touch Selection Improvements
   ============================================================================= */

/* Larger selection handles on mobile */
@media (max-width: 767px) {
  ::selection {
    background: rgba(var(--color-primary-rgb, 8, 145, 178), 0.3);
  }

  /* Prevent text selection on UI elements */
  .toolbar-btn,
  .editor-btn,
  .tag-chip,
  .panel-toggle {
    user-select: none;
    -webkit-user-select: none;
  }

  /* Allow text selection in content areas */
  .editor-textarea,
  .preview-pane,
  .content-view {
    user-select: text;
    -webkit-user-select: text;
  }
}

/* =============================================================================
   iOS-Specific Fixes
   ============================================================================= */

/* Prevent iOS from zooming on input focus (font-size must be >= 16px) */
@supports (-webkit-touch-callout: none) {
  input,
  textarea,
  select {
    font-size: max(16px, 1em);
  }

  /* Fix iOS momentum scrolling */
  .scroll-container {
    -webkit-overflow-scrolling: touch;
  }

  /* Fix iOS safe area in landscape */
  @media (orientation: landscape) {
    .editor-panel {
      padding-left: env(safe-area-inset-left, 0);
      padding-right: env(safe-area-inset-right, 0);
    }
  }
}
